<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Ibon Martínez-Arranz" /><link rel="canonical" href="https://github.com/imarranz/essential-guide-to-pandas/090_advanced_data_transformation.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Advanced Data Transformation - Essential Guide to Pandas</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Advanced Data Transformation";
        var mkdocs_page_input_path = "090_advanced_data_transformation.md";
        var mkdocs_page_url = "/imarranz/essential-guide-to-pandas/090_advanced_data_transformation.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> Essential Guide to Pandas
        </a>
        <div class="version">
          1.0
        </div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Essential Guide to Pandas</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Handling</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="010_data_loading.html">Data Loading</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="020_basic_data_inspection.html">Basic Data Inspection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="030_data_cleaning.html">Data Cleaning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="080_data_formatting_and_conversion.html">Data Formatting and Conversion</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="220_dealing_with_missing_data.html">Dealing with Missing Data</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Analysis</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="040_data_transformation.html">Data Transformation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="050_data_visualization_integration.html">Data Visualization Integration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="060_statistical_analysis.html">Statistical Analysis</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="090_advanced_data_transformation.html">Advanced Data Transformation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="180_advanced_grouping_and_aggregation.html">Advanced Grouping and Aggregation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="190_text_data_specific_operations.html">Text Data Specific Operations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="200_working_with_json_and_xml.html">Working with JSON and XML</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Manipulation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="070_indexing_and_selection.html">Indexing and Selection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="130_multi-index_operations.html">Multi-Index Operations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="230_data_reshaping.html">Data Reshaping</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="240_categorical_data_operations.html">Categorical Data Operations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="250_advanced_indexing.html">Advanced Indexing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Integration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="100_handling_time_series_data.html">Handling Time Series</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="110_file_export.html">File Export</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="210_advanced_file_handling.html">Advanced File Handling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="270_advanced_data_merging.html">Advanced Data Merging</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Quality Control</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="140_data_merging_techniques.html">Data Merging Techniques</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="150_dealing_with_duplicates.html">Dealing with Duplicates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="160_custom_operations_with_apply.html">Custom Operations with Apply</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="170_integration_with_matplotlib_for_custom_plots.html">Integration with Matplotlib for Custom Plots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="260_efficient_computations.html">Efficient Computations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280_data_quality_checks.html">Data Quality Checks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="290_real_word_case_studies.html">Real-World Case Studies</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Essential Guide to Pandas</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Data Analysis &raquo;</li>
      <li class="breadcrumb-item active">Advanced Data Transformation</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/imarranz/essential-guide-to-pandas/edit/master/docs/090_advanced_data_transformation.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
    <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Breadcrumb Navigation">
        <a href="060_statistical_analysis.html" class="btn btn-neutral float-left" title="Statistical Analysis"><span class="icon icon-circle-arrow-left" aria-hidden="true"></span> Previous</a>
        <a href="180_advanced_grouping_and_aggregation.html" class="btn btn-neutral float-right" title="Advanced Grouping and Aggregation">Next <span class="icon icon-circle-arrow-right" aria-hidden="true"></span></a>
    </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="advanced_data_transformation">Advanced Data Transformation<a class="headerlink" href="#advanced_data_transformation" title="Permanent link">#</a></h1>
<p>Advanced data transformation involves sophisticated techniques that help in reshaping, restructuring, and summarizing complex datasets. This chapter delves into some of the more advanced functions available in Pandas that enable detailed manipulation and transformation of data.</p>
<h2 id="lambda_functions">Lambda Functions<a class="headerlink" href="#lambda_functions" title="Permanent link">#</a></h2>
<p>Lambda functions provide a quick and efficient way of applying an operation across a DataFrame. Here’s how you can use <code>apply</code> with a lambda function to increment every element in the DataFrame:</p>
<pre><code class="language-python">import pandas as pd

# Sample DataFrame
data = {'A': [1, 2, 3],
        'B': [4, 5, 6]}
df = pd.DataFrame(data)

# Applying a lambda function to add 1 to each element
df = df.apply(lambda x: x + 1)
print(df)
</code></pre>
<p>Result:</p>
<pre><code class="language-plaintext">   A  B
0  2  5
1  3  6
2  4  7
</code></pre>
<h2 id="pivot_longerwider_format">Pivot Longer/Wider Format<a class="headerlink" href="#pivot_longerwider_format" title="Permanent link">#</a></h2>
<p>The <code>melt</code> function is used to transform data from wide format to long format, which can be more suitable for analysis:</p>
<pre><code class="language-python"># Example of melting a DataFrame
data = {'Name': ['Alice', 'Bob'],
        'Age': [25, 30],
        'Salary': [50000, 60000]}
df = pd.DataFrame(data)

# Pivoting from wider to longer format
df_long = df.melt(id_vars = ['Name'])
print(df_long)
</code></pre>
<p>Result:</p>
<pre><code class="language-plaintext">    Name variable  value
0  Alice      Age     25
1    Bob      Age     30
2  Alice   Salary  50000
3    Bob   Salary  60000
</code></pre>
<h2 id="stackunstack">Stack/Unstack<a class="headerlink" href="#stackunstack" title="Permanent link">#</a></h2>
<p>Stacking and unstacking are powerful for reshaping a DataFrame by pivoting the columns or the index:</p>
<pre><code class="language-python"># Stacking and unstacking example
df = pd.DataFrame(data)

# Stacking
stacked = df.stack()
print(stacked)

# Unstacking
unstacked = stacked.unstack()
print(unstacked)
</code></pre>
<p>Result for stack:</p>
<pre><code class="language-plaintext">0  Name      Alice
   Age          25
   Salary    50000
1  Name        Bob
   Age          30
   Salary    60000
dtype: object
</code></pre>
<p>Result for unstack:</p>
<pre><code class="language-plaintext">    Name Age Salary
0  Alice  25  50000
1    Bob  30  60000
</code></pre>
<h2 id="cross_tabulations">Cross Tabulations<a class="headerlink" href="#cross_tabulations" title="Permanent link">#</a></h2>
<p>Cross tabulations are used to compute a simple cross-tabulation of two (or more) factors. This can be very useful in statistics and probability analysis:</p>
<pre><code class="language-python"># Cross-tabulation example
data = {'Gender': ['Female', 'Male', 'Female', 'Male'],
        'Handedness': ['Right', 'Left', 'Right', 'Right']}
df = pd.DataFrame(data)

# Creating a cross tabulation
crosstab = pd.crosstab(df['Gender'], df['Handedness'])
print(crosstab)
</code></pre>
<p>Result:</p>
<pre><code class="language-plaintext">Handedness  Left  Right
Gender
Female        0      2
Male          1      1
</code></pre>
<p>These advanced transformations enable sophisticated handling of data structures, enhancing the ability to analyze complex datasets effectively.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p><b>Essential Guide to Pandas</b> <br>Copyright &#169; 2024 <a href="https://github.com/imarranz">Ibon Martínez-Arranz</a><br></p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/imarranz/essential-guide-to-pandas" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="060_statistical_analysis.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="180_advanced_grouping_and_aggregation.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
